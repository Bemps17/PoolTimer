<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Timer de Billard Pro (PWA)</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a1a1a">

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üé±</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@700&family=Poppins:wght@600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    
    <link rel="stylesheet" href="style.css">
</head>
<body id="appBody">
    <div class="scoreboard-body" id="container">
        <div class="top-bar">
            <div class="top-bar-players">
                <div class="player-status" id="p1Status" data-player="1">
                    <span class="player-name">P1</span> <span class="ext-status">EXT</span>
                </div>
                <div class="player-status" id="p2Status" data-player="2">
                    <span class="player-name">P2</span> <span class="ext-status">EXT</span>
                </div>
            </div>
            <div class="top-bar-controls">
                <div class="icon-button" id="btnFullScreen" aria-label="Plein √©cran">
                    <svg class="expand-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg>
                    <svg class="compress-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"/></svg>
                </div>
                <div class="icon-button" id="menuArbitre" aria-label="Ouvrir le menu">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19.14 12.94c.04-.3.06-.61.06-.94s-.02-.64-.07-.94l2-1.55a.39.39 0 0 0 .09-.58l-1.73-3a.38.38 0 0 0-.5-.24l-2.38.96a6.38 6.38 0 0 0-1.64-.94l-.38-2.61a.38.38 0 0 0-.38-.34H8.46a.38.38 0 0 0-.38.34l-.38 2.61a6.38 6.38 0 0 0-1.64.94l-2.38-.96a.38.38 0 0 0-.5.24l-1.73 3a.39.39 0 0 0 .09.58l2 1.55c-.05.3-.07.64-.07.94s.02.64.07.94l-2 1.55a.39.39 0 0 0-.09.58l1.73 3a.38.38 0 0 0 .5.24l2.38-.96a6.38 6.38 0 0 0 1.64.94l.38 2.61a.38.38 0 0 0 .38.34h3.46a.38.38 0 0 0 .38-.34l.38-2.61a6.38 6.38 0 0 0 1.64-.94l2.38.96a.38.38 0 0 0 .5-.24l1.73-3a.39.39 0 0 0-.09-.58l-2-1.55zM12 15.5a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7z"/></svg>
                </div>
            </div>
        </div>

        <div class="timer-screen" id="timerScreen">
            <div class="timer-content">
                <div class="timer-officiel state-default" id="timerDisplay">45</div>
            </div>
            <div class="timer-extension-bar" id="btnExtension">EXTENSION</div>
        </div>

        <div class="control-panel" id="controlPanel">
            <button class="bouton-sport" id="btnResetShot" aria-label="Coup Suivant">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"></path></svg>
            </button>
            <button class="bouton-sport" id="btnPlayPause" aria-label="D√©marrer"></button>
            <button class="bouton-sport bouton-carr√©" id="btnNewGame" aria-label="Nouvelle Partie">NEW</button>
        </div>
    </div>

    <div class="overlay" id="overlayMenu"></div>
    <div class="panel" id="panelArbitre">
        <div class="header-panel">
            <h2>Configuration</h2>
            <button class="fermer-panel" id="fermerPanel" aria-label="Fermer le menu">&times;</button>
        </div>
        <div class="panel-content" id="panelContent">
            <div class="section-panel">
                <h3>Joueurs</h3>
                <div class="parametre-groupe">
                    <label for="p1Name">Joueur 1</label>
                    <div class="player-config">
                        <input type="text" id="p1Name" maxlength="5" placeholder="P1">
                        <input type="color" id="p1Color" value="#3498db">
                    </div>
                </div>
                <div class="parametre-groupe">
                    <label for="p2Name">Joueur 2</label>
                    <div class="player-config">
                        <input type="text" id="p2Name" maxlength="5" placeholder="P2">
                        <input type="color" id="p2Color" value="#e74c3c">
                    </div>
                </div>
            </div>
            
            <div class="section-panel">
                <h3>Param√®tres de Jeu</h3>
                <div class="parametre-groupe">
                    <label for="tempsBase">Temps de base (sec)</label>
                    <input type="number" id="tempsBase" min="10" max="120">
                </div>
                <div class="parametre-groupe">
                    <label for="tempsExtension">Temps d'extension (sec)</label>
                    <input type="number" id="tempsExtension" min="5" max="60">
                </div>
                <div class="parametre-groupe">
                    <label for="seuilAlerte">Seuil Alerte Orange (sec)</label>
                    <input type="number" id="seuilAlerte" min="1" max="119">
                </div>
                <div class="parametre-groupe">
                    <label for="seuilCritique">Seuil Alerte Rouge (sec)</label>
                    <input type="number" id="seuilCritique" min="1" max="119">
                </div>
            </div>
            
            <div class="section-panel">
                <h3>Interface & Audio</h3>
                <div class="parametre-groupe">
                    <label for="themeVisuel">Th√®me visuel</label>
                     <select id="themeVisuel">
                        <option value="sombre">Sombre</option>
                        <option value="light">Clair</option>
                        <option value="cyberpunk">Cyberpunk</option>
                    </select>
                </div>
                <div class="parametre-groupe">
                    <label for="modeInterface">Mode d'interface</label>
                    <select id="modeInterface">
                        <option value="boutons">Boutons Visibles</option>
                        <option value="tactile">Mode Tactile Complet</option>
                    </select>
                </div>
                 <div class="parametre-groupe">
                    <label for="affichageMs">Affichage millisecondes (sous 10s)</label>
                    <select id="affichageMs">
                        <option value="true">Oui</option>
                        <option value="false">Non</option>
                    </select>
                </div>
                 <div class="parametre-groupe">
                    <label for="volumeSonore">Volume g√©n√©ral</label>
                    <input type="range" id="volumeSonore" min="0" max="1" step="0.1">
                </div>
                <div class="parametre-groupe">
                    <label for="sonAlertes">Sons d'alerte (timer)</label>
                     <select id="sonAlertes">
                        <option value="true">Activ√©s</option>
                        <option value="false">D√©sactiv√©s</option>
                    </select>
                </div>
                <div class="parametre-groupe">
                    <label for="sonClics">Sons des clics (interface)</label>
                     <select id="sonClics">
                        <option value="true">Activ√©s</option>
                        <option value="false">D√©sactiv√©s</option>
                    </select>
                </div>
                <div class="parametre-groupe">
                    <label for="vibrationMobile">Vibration mobile</label>
                     <select id="vibrationMobile">
                        <option value="true">Activ√©e</option>
                        <option value="false">D√©sactiv√©e</option>
                    </select>
                </div>
            </div>

            <div class="section-panel">
                <h3>Automatisation</h3>
                <div class="parametre-groupe">
                    <label for="autoStartOnReset">Red√©marrage auto apr√®s reset</label>
                     <select id="autoStartOnReset">
                        <option value="true">Oui</option>
                        <option value="false">Non</option>
                    </select>
                </div>
            </div>
            
            <div class="section-panel">
                 <button class="bouton-menu" id="btnShowHelp">Mode d'emploi</button>
            </div>
        </div>
    </div>

    <div class="overlay" id="overlayHelp"></div>
    <div class="panel-help" id="panelHelp">
        <div class="header-panel">
            <h2>Mode d'emploi</h2>
            <button class="fermer-panel" id="fermerHelp" aria-label="Fermer l'aide">&times;</button>
        </div>
        <div class="help-content">
            <p>Bienvenue sur le Timer de Billard Pro ! Cette application est con√ßue pour arbitrer vos parties avec pr√©cision, simplicit√© et style.</p>
            
            <h3>Contr√¥les Principaux</h3>
            <ul>
                <li><strong>Clic Simple (√âcran) :</strong> Lance ou met en pause le chronom√®tre.</li>
                <li><strong>Double-clic (√âcran) :</strong> R√©initialise le temps pour le joueur actuel.</li>
                <li><strong>Cliquez sur P1/P2 :</strong> Change de joueur et r√©initialise le temps.</li>
                <li><strong>Ic√¥ne Plein √âcran ( haut-droite) :</strong> Affiche le timer en plein √©cran pour une immersion totale.</li>
            </ul>

            <h3>Acc√©der aux Param√®tres (‚öôÔ∏è)</h3>
            <p>Cliquez sur l'ic√¥ne roue crant√©e en haut √† droite pour personnaliser :</p>
            <ul>
                <li><strong>Les Noms et Couleurs</strong> des joueurs.</li>
                <li><strong>Les Temps</strong> de base et d'extension.</li>
                <li><strong>Les Seuils d'Alerte</strong> visuelle (orange et rouge).</li>
                <li><strong>Le Th√®me Visuel</strong> (Sombre, Clair, Cyberpunk).</li>
                <li><strong>Les Sons</strong> (volume, activation des alertes/clics).</li>
                <li><strong>Le Mode d'Interface</strong> (boutons ou tout tactile).</li>
                <li>Et plus encore... Vos choix sont sauvegard√©s automatiquement.</li>
            </ul>
            <p><strong>Note :</strong> Pour que la <strong>vibration</strong> fonctionne, assurez-vous que votre t√©l√©phone n'est pas en mode silencieux et que les vibrations sont autoris√©es pour le navigateur dans les r√©glages de votre appareil.</p>
        </div>
    </div>

    <div id="saveToast" class="save-toast">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"></path></svg>
        <span>Param√®tres sauvegard√©s !</span>
    </div>

    <script src="script.js"></script>

    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(registration => {
              console.log('Service Worker enregistr√© avec succ√®s ! Scope:', registration.scope);
            })
            .catch(error => {
              console.log('√âchec de l\'enregistrement du Service Worker:', error);
            });
        });
      }
    </script>
</body>
</html>
